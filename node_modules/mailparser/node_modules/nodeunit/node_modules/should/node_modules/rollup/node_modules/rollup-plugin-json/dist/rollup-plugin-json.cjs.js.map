{"version":3,"file":"rollup-plugin-json.cjs.js","sources":["..//Volumes/Storage/www/ROLLUP/plugins/rollup-plugin-json/src/index.js"],"sourcesContent":["import { createFilter, makeLegalIdentifier } from 'rollup-pluginutils';\n\nexport default function json ( options = {} ) {\n\tconst filter = createFilter( options.include, options.exclude );\n\n\treturn {\n\t\tname: 'json',\n\n\t\ttransform ( json, id ) {\n\t\t\tif ( id.slice( -5 ) !== '.json' ) return null;\n\t\t\tif ( !filter( id ) ) return null;\n\n\t\t\tlet code;\n\t\t\tlet ast = {\n\t\t\t\ttype: 'Program',\n\t\t\t\tsourceType: 'module',\n\t\t\t\tstart: 0,\n\t\t\t\tend: null,\n\t\t\t\tbody: []\n\t\t\t};\n\n\t\t\tif ( json[0] !== '{' ) {\n\t\t\t\tcode = `export default ${json};`;\n\n\t\t\t\tast.body.push({\n\t\t\t\t\ttype: 'ExportDefaultDeclaration',\n\t\t\t\t\tstart: 0,\n\t\t\t\t\tend: code.length,\n\t\t\t\t\tdeclaration: {\n\t\t\t\t\t\ttype: 'Literal',\n\t\t\t\t\t\tstart: 15,\n\t\t\t\t\t\tend: code.length - 1,\n\t\t\t\t\t\tvalue: null,\n\t\t\t\t\t\traw: 'null'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst data = JSON.parse( json );\n\n\t\t\t\tconst validKeys = [];\n\t\t\t\tconst invalidKeys = [];\n\n\t\t\t\tObject.keys( data ).forEach( key => {\n\t\t\t\t\tif ( key === makeLegalIdentifier( key ) ) {\n\t\t\t\t\t\tvalidKeys.push( key );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tinvalidKeys.push( key );\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tlet char = 0;\n\t\t\t\tconst namedExports = validKeys.map( key => {\n\t\t\t\t\tconst declaration = `export var ${key} = ${JSON.stringify( data[ key ] )};`;\n\n\t\t\t\t\t// generate fake AST node while we're here\n\t\t\t\t\tast.body.push({\n\t\t\t\t\t\ttype: 'ExportNamedDeclaration',\n\t\t\t\t\t\tstart: char,\n\t\t\t\t\t\tend: declaration.length,\n\t\t\t\t\t\tdeclaration: {\n\t\t\t\t\t\t\ttype: 'VariableDeclaration',\n\t\t\t\t\t\t\tstart: char + 7,\n\t\t\t\t\t\t\tend: declaration.length,\n\t\t\t\t\t\t\tdeclarations: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttype: 'VariableDeclarator',\n\t\t\t\t\t\t\t\t\tstart: char + 11,\n\t\t\t\t\t\t\t\t\tend: declaration.length - 1,\n\t\t\t\t\t\t\t\t\tid: {\n\t\t\t\t\t\t\t\t\t\ttype: 'Identifier',\n\t\t\t\t\t\t\t\t\t\tstart: char + 11,\n\t\t\t\t\t\t\t\t\t\tend: char + 11 + key.length,\n\t\t\t\t\t\t\t\t\t\tname: key\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tinit: {\n\t\t\t\t\t\t\t\t\t\ttype: 'Literal',\n\t\t\t\t\t\t\t\t\t\tstart: char + 11 + key.length + 3,\n\t\t\t\t\t\t\t\t\t\tend: declaration.length - 1,\n\t\t\t\t\t\t\t\t\t\tvalue: null,\n\t\t\t\t\t\t\t\t\t\traw: 'null'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tkind: 'var'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tspecifiers: [],\n\t\t\t\t\t\tsource: null\n\t\t\t\t\t});\n\n\t\t\t\t\tchar += declaration.length + 1;\n\t\t\t\t\treturn declaration;\n\t\t\t\t});\n\n\t\t\t\tconst defaultExportNode = {\n\t\t\t\t\ttype: 'ExportDefaultDeclaration',\n\t\t\t\t\tstart: char,\n\t\t\t\t\tend: null,\n\t\t\t\t\tdeclaration: {\n\t\t\t\t\t\ttype: 'ObjectExpression',\n\t\t\t\t\t\tstart: char + 15,\n\t\t\t\t\t\tend: null,\n\t\t\t\t\t\tproperties: []\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tchar += 18; // 'export default {\\n\\t'.length'\n\n\t\t\t\tconst defaultExportRows = validKeys.map( key => {\n\t\t\t\t\tconst row = `${key}: ${key}`;\n\n\t\t\t\t\tdefaultExportNode.declaration.properties.push({\n\t\t\t\t\t\ttype: 'Property',\n\t\t\t\t\t\tstart: char,\n\t\t\t\t\t\tend: char + row.length,\n\t\t\t\t\t\tmethod: false,\n\t\t\t\t\t\tshorthand: false,\n\t\t\t\t\t\tcomputed: false,\n\t\t\t\t\t\tkey: {\n\t\t\t\t\t\t\ttype: 'Identifier',\n\t\t\t\t\t\t\tstart: char,\n\t\t\t\t\t\t\tend: key.length,\n\t\t\t\t\t\t\tname: key\n\t\t\t\t\t\t},\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\ttype: 'Identifier',\n\t\t\t\t\t\t\tstart: char + key.length + 2,\n\t\t\t\t\t\t\tend: char + row.length,\n\t\t\t\t\t\t\tname: key\n\t\t\t\t\t\t},\n\t\t\t\t\t\tkind: 'init'\n\t\t\t\t\t});\n\n\t\t\t\t\tchar += row.length + 3; // ',\\n\\t'.length\n\n\t\t\t\t\treturn row;\n\t\t\t\t}).concat( invalidKeys.map( key => `\"${key}\": ${JSON.stringify( data[ key ] )}` ) );\n\n\t\t\t\tconst defaultExportString = `export default {\\n\\t${defaultExportRows.join( ',\\n\\t' )}\\n};`;\n\n\t\t\t\tast.body.push( defaultExportNode );\n\t\t\t\tcode = `${namedExports.join( '\\n' )}\\n${defaultExportString}`;\n\n\t\t\t\tdefaultExportNode.end = defaultExportNode.declaration.end = code.length - 1;\n\t\t\t}\n\n\t\t\tast.end = code.length;\n\n\t\t\treturn { ast, code, map: { mappings: '' } };\n\t\t}\n\t};\n}\n"],"names":["createFilter","makeLegalIdentifier"],"mappings":"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"}